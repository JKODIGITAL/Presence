# Dockerfile.api-base - Depend√™ncias espec√≠ficas da API
FROM presence-common-base:latest

# Copiar apenas o arquivo de requisitos
COPY requirements.txt .

# --- Instala√ß√£o de depend√™ncias Python ---
RUN conda run -n presence pip install --no-cache-dir --upgrade pip setuptools wheel && \
    conda run -n presence pip install --no-cache-dir -r requirements.txt

# --- Pr√©-download de Modelos ---
RUN mkdir -p /root/presence/data/models && \
    echo "üì¶ Modelos InsightFace ser√£o baixados no primeiro uso" || true

# Criar estrutura de diret√≥rios
RUN mkdir -p /root/presence/data/{db,models,uploads,embeddings,images,frames,unknown_faces} /root/presence/logs && \
    mkdir -p /root/presence/data/uploads/{people,unknown}

# Configurar vari√°veis de ambiente para o container
ENV PYTHONPATH=/root/presence
ENV INSIGHTFACE_HOME=/root/presence/data/models
ENV GST_DEBUG=2
ENV GST_DEBUG_DUMP_DOT_DIR=/tmp/gstreamer-debug 
